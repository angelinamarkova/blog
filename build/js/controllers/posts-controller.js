"use strict";var _slicedToArray=function(){function e(e,t){var r=[],a=!0,o=!1,l=void 0;try{for(var n,i=e[Symbol.iterator]();!(a=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(e){o=!0,l=e}finally{try{!a&&i.return&&i.return()}finally{if(o)throw l}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),blogControllers={get:function(e,t){function r(r){t.get("comments").then(function(t){var a=Handlebars.compile(t),o={},l=void 0,n=void 0,i=void 0,s=void 0;e.getPostComments(r).on("value",function(t){o.comments=t.val(),l=a(o),$(".post-comments").html(l),$(".btn-add-comment").click(function(t){i=$("#name"),s=$("#message").val(),n={authorKey:JSON.parse(localStorage.getItem("currentUser")).uid,authorName:JSON.parse(localStorage.getItem("currentUser")).displayName,authorEmail:JSON.parse(localStorage.getItem("currentUser")).email,authorImg:JSON.parse(localStorage.getItem("currentUser")).photoURL,content:s,timestamp:firebase.database.ServerValue.TIMESTAMP},e.createComment(r,n).then(function(e){toastr.info("Thanks for your comment")}).catch(function(e){return toastr.info("Comment could not be posted")})})})})}function a(e,r){var a={};"search"==e?(e="title_lower",a=BLOG_HOME_PAGE_DATA_SEARCH):"category"==e&&(a=BLOG_HOME_CATEGORY,a.title=r+" Category",a.breadcrumbs[2].title=r),Promise.all([t.get("blog"),t.get("page-header"),t.get("sidebar")]).then(function(t){var o=_slicedToArray(t,3),l=o[0],n=o[1],i=o[2],s=firebase.database().ref("posts");s.orderByChild(e).startAt(r).endAt(r+"ï£¿").once("value",function(e){var t={posts:e.val(),page:a,categories:JSON.parse(getLocalStorageItem("categories"))};t.page.searchValue=r;var o=Handlebars.compile(l),c=Handlebars.compile(n),g=Handlebars.compile(i),m=o(t),u=c(t.page),d=g(t);$("#container").html(m),$(".page-header").html(u),$(".sidebar").html(d),s.off()})})}return{blogHome:function(){if(arguments[1]){a(arguments[1].split("=")[0],arguments[1].split("=")[1])}else Promise.all([e.getAllCategories(),e.getAllPosts(),t.get("blog"),t.get("page-header"),t.get("sidebar")]).then(function(e){var t=_slicedToArray(e,5),r=t[0],a=t[1],o=t[2],l=t[3],n=t[4],i=Handlebars.compile(o),s=Handlebars.compile(l),c=Handlebars.compile(n),g={},m=BLOG_HOME_PAGE_DATA,u=void 0,d=void 0,p=void 0;setLocalStorageItem("categories",JSON.stringify(r.val())),g.categories=r.val(),g.posts=a.val(),u=i(g),d=s(m),p=c(g),$("#container").html(u),$(".page-header").html(d),$(".sidebar").html(p)}).catch(function(e){return console.log(e)})},blogSingle:function(a){Promise.all([e.getAllCategories(),e.getAllPosts(),e.getPostByKey(a.key),t.get("blog-single"),t.get("page-header"),t.get("sidebar")]).then(function(e){var t=_slicedToArray(e,6),o=t[0],l=t[1],n=t[2],i=t[3],s=t[4],c=t[5],g=Handlebars.compile(i),m=Handlebars.compile(s),u=Handlebars.compile(c),d={},p=BLOG_SINGLE_PAGE_DATA,b=void 0,h=void 0,f=void 0;d.categories=o.val(),d.posts=l.val(),d.post=n.val(),p.title=d.post.title,p.subtitle=d.post.subtitle,p.breadcrumbs[2]={url:"#/blog/"+a.key,title:d.post.title},b=g(d),h=m(p),f=u(d),$("#container").html(b),$(".page-header").html(h),$(".sidebar").html(f),r(a.key)}).catch(function(e){return console.log(e)})}}}};